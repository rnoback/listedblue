"console"in window&&window.console.log||(window.console={log:function(){}});var settings;!function(a){window.LISTEDBLUE={version:.1,touch:!!("ontouchstart"in window),logEl:"#notification",logEvent:"show-message",settings:{debug:!0},init:function(a){this.dataURL="json/data.json",this.fetch(),this.template=a.template,this.container=a.container},pubSub:function(){var b=a({});a.each({trigger:"publish",on:"subscribe",off:"unsubscribe"},function(a,c){jQuery[c]=function(){b[a].apply(b,arguments)}})},attachTemplate:function(){console.log(this.products),console.log("this.products.product_name "+this.products[0].product_name);var a=Handlebars.compile(this.template),b=a(this.products);console.log(b),this.container.append(a(this.products))},fetch:function(){var b=this;a.getJSON(this.dataURL,function(c){b.products=a.map(c.products,function(a){return{product_id:a.product_id,product_name:a.product_name,product_visual:a.product_visual}}),console.log(b.products),b.attachTemplate();setTimeout(b.setInterface.bind(b),2e3)})},setInterface:function(){this.isPortrait=!1,this.theBody=a("body"),this.theWindow=a(window),this.header=a("header"),this.footer=a("footer"),this.mainWrap=a(".main-wrap"),this.productWrap=a(".product-wrap"),this.productInfo=a(".product-info"),this.selectedProductIndex=0,this.mainVisuals=a(".product-visual").find("img"),this.AllProducts=this.productWrap.find(".product"),this.AllProducts.css("display","none"),this.maxProducts=this.AllProducts.length,this.setProduct(this.selectedProductIndex),this.viewportWidth=this.theWindow.width(),this.viewportHeight=this.theWindow.outerHeight(),this.heightTotal=this.mainWrap.height(),this.productVisual=a(".product-visual"),this.productInfo=a(".product-info"),this.restHeigth=this.footer.height()+this.productInfo.height(),this.productVisualHeight=this.viewportHeight-this.restHeigth,this.theWindow.on("orientationchange",this.onTurnScreen.bind(this)),this.applyOrientation(),this.setMainVisial(),this.theWindow.on("resize",this.resizeHandler.bind(this));setTimeout(this.resizeHandler.bind(this),100);a(".next").on("click",this.setNextProductIndex.bind(this)),a(".prev").on("click",this.setPrevProductIndex.bind(this))},getProduct:function(b){return a(this.AllProducts[b])},setProduct:function(b){this.curProduct=a(this.AllProducts[b]),this.mainVisual=this.curProduct.find("img"),this.toggleProduct()},toggleProduct:function(){this.oldProduct&&this.oldProduct.css("display","none"),this.curProduct.fadeIn("slow",function(){this.oldProduct});setTimeout(this.resizeHandler.bind(this),1)},setNextProductIndex:function(a){a.preventDefault(),this.oldProduct=this.curProduct,this.selectedProductIndex<this.maxProducts-1?this.selectedProductIndex++:this.selectedProductIndex=0,this.setProduct(this.selectedProductIndex),console.log("NEXT : "+this.selectedProductIndex)},setPrevProductIndex:function(a){a.preventDefault(),this.oldProduct=this.curProduct,this.selectedProductIndex>0?this.selectedProductIndex--:this.selectedProductIndex=this.maxProducts-1,this.setProduct(this.selectedProductIndex),console.log("PREV : "+this.selectedProductIndex)},setMainVisial:function(){this.isPortrait||(this.heightTotal>=this.viewportHeight?(this.mainVisual.css("width","auto"),this.mainVisual.css("height",this.productVisualHeight+"px")):(this.mainVisual.css("width","100%"),this.mainVisual.css("height","auto")))},applyOrientation:function(){window.innerHeight>window.innerWidth?this.setPortraitMode():this.setLandscapeMode()},onTurnScreen:function(){0==window.orientation},setPortraitMode:function(){console.log("You are now in portrait"),this.isPortrait=!0,this.theBody.addClass("is-portrait"),this.theBody.removeClass("is-landscape"),this.mainVisual.css("height",this.viewportHeight+"px"),this.mainVisual.css("width","auto"),this.header.css("width",this.mainVisual.width()),this.footer.css("width",this.mainVisual.width()),this.productInfo.css("width",this.mainVisual.width());var a=(this.mainVisual.width()-this.viewportWidth)/2;console.log("this.mainVisual.width "+this.mainVisual.width()),console.log("this.viewportWidth "+this.viewportWidth),console.log("scrollto "+a);this.viewportWidth-a;window.scrollTo(a,0)},setLandscapeMode:function(){console.log("You are now in landscape"),this.isPortrait=!1,this.theBody.removeClass("is-portrait"),this.theBody.addClass("is-landscape"),this.mainVisual.css("width","100%"),this.mainVisual.css("height","auto"),this.header.css("width","100%"),this.productInfo.css("width","100%"),this.footer.css("width","100%"),window.scrollTo(0,0)},scrollHandler:function(){},resizeHandler:function(){this.applyOrientation(),this.viewportHeight=this.theWindow.outerHeight(),this.viewportWidth=this.theWindow.outerWidth(),this.heightTotal=this.mainWrap.height(),this.productVisualHeight=this.viewportHeight-this.restHeigth,this.setMainVisial()}},a(function(){LISTEDBLUE.init({template:a("#product-template").html(),container:a(".product-wrap")})})}(window.jQuery);